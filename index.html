<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Productivity and EOD App</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #e6effc, #d1e0f7);
            color: #003366;
        }

        header {
            background: linear-gradient(90deg, #003366, #d32f2f);
            color: white;
            padding: 1.5rem;
            text-align: center;
            font-size: 2rem;
            letter-spacing: 1.5px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .container {
            margin: 2rem auto;
            max-width: 90%;
            background: rgba(255, 255, 255, 0.9);
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        }

        label {
            font-size: 1.1rem;
            font-weight: bold;
            display: block;
            margin-bottom: 0.5rem;
            color: #003366;
        }

        select, input, button, textarea {
            width: 100%;
            padding: 0.8rem;
            margin-bottom: 1rem;
            border: none;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            font-size: 1rem;
        }

        select {
            background-color: #f5faff;
            color: #003366;
        }

        input {
            background-color: #f0f5ff;
            color: #003366;
            width: 100%;
        }

        button {
            background-color: #004990;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        button:hover {
            background-color: #003366;
        }

        ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        li {
            background: #e6effc;
            margin: 0.5rem 0;
            padding: 1rem;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        li button {
            width: 20px;
            height: 20px;
            background-color: #cc0000;
            color: white;
            border: none;
            font-size: 0.8rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-left: auto;
            border-radius: 4px;
        }

        li button:hover {
            background-color: #990000;
        }

        #totalTime {
            font-size: 1.5rem;
            font-weight: bold;
            text-align: center;
            margin-top: 1rem;
            color: #003366;
        }

        #totalTime.negative {
            color: #cc0000;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
            display: none;
        }

        th, td {
            padding: 0.8rem;
            border: 1px solid #ddd;
        }

        th {
            background-color: #003366;
            color: white;
            text-align: left;
        }


        /* Make the Task column smaller */
        th:first-child, td:first-child {
            width: 5%; /* Adjust width of Task column */
            padding: 0.4rem 0.6rem; /* Reduce padding */
            white-space: nowrap; /* Prevent text wrapping */
            overflow: hidden;
            text-overflow: ellipsis; /* Add "..." if the text is too long */
        }

        th:nth-child(2), td:nth-child(2),
        th:nth-child(3), td:nth-child(3) {
            width: 10%; /* Quantity and Time columns */
            padding: 0.4rem;
            text-align: center;
        }

        .visible {
            display: table; /* Make the table visible when this class is applied */
        }

        @media (max-width: 600px) {
            header {
                font-size: 1.5rem;
                padding: 1rem;
            }

            .container {
                padding: 1rem;
            }

            label {
                font-size: 1rem;
            }

            select, input, button, textarea {
                font-size: 0.9rem;
                padding: 0.6rem;
            }

            li {
                padding: 0.8rem;
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <header>
        Productivity & EOD Tracker
    </header>

    <div class="container">
        <label for="task">Select Task:</label>
        <select id="task">
            <option value="">-- Select a Task --</option>

            <optgroup label="Sortation & Tracking">
                <option value="Morning Mail Sort|1">Morning Mail Sort (1 min)</option>
                <option value="Afternoon Mail Sort|1">Afternoon Mail Sort (1 min)</option>
                <option value="Afternoon Mail|2">Afternoon Mail (2 min)</option>
                <option value="Tracking|1">Tracking (1 min)</option>
            </optgroup>

            <optgroup label="Faxes & Sweeps">
                <option value="Faxes|15 mins">Faxes (.25")</option>
                <option value="Faxes|30 mins">Faxes (.50")</option>
                <option value="Faxes|45 mins">Faxes (.75")</option>
                <option value="Faxes|60 mins">Faxes (1")</option>
                <option value="Sweeps|30">Sweeps (30 min)</option>
            </optgroup>

            <optgroup label="400 Benefits">
                <option value="Mailroom 400 Full Tray|120">Mailroom 400 Full Tray (120 min)</option>
                <option value="Mailroom 400 .75 Tray|90">Mailroom 400 .75 Tray (90 min)</option>
                <option value="Mailroom 400 .50 Tray|60">Mailroom 400 .50 Tray (60 min)</option>
                <option value="Mailroom 400 .25 Tray|30">Mailroom 400 .25 Tray (30 min)</option>
                <option value="Mailroom 400 Full Tub|90">Mailroom 400 Full Tub (90 min)</option>
                <option value="Mailroom 400 .75 Tub|68">Mailroom 400 .75 Tub (68 min)</option>
                <option value="Mailroom 400 .50 Tub|45">Mailroom 400 .50 Tub (45 min)</option>
                <option value="Mailroom 400 .25 Tub|23">Mailroom 400 .25 Tub (23 min)</option>
            </optgroup>

            <optgroup label="500 Retirements">
                <option value="Mailroom 500 Full Tray|105">Mailroom 500 Full Tray (105 min)</option>
                <option value="Mailroom 500 .75 Tray|79">Mailroom 500 .75 Tray (79 min)</option>
                <option value="Mailroom 500 .50 Tray|53">Mailroom 500 .50 Tray (53 min)</option>
                <option value="Mailroom 500 .25 Tray|26">Mailroom 500 .25 Tray (26 min)</option>
                <option value="Mailroom 500 Full Tub|120">Mailroom 500 Full Tub (120 min)</option>
                <option value="Mailroom 500 .75 Tub|90">Mailroom 500 .75 Tub (90 min)</option>
                <option value="Mailroom 500 .50 Tub|60">Mailroom 500 .50 Tub (60 min)</option>
                <option value="Mailroom 500 .25 Tub|30">Mailroom 500 .25 Tub (30 min)</option>
            </optgroup>

            <optgroup label="600 VERA">
                <option value="Mailroom 600 Full Tub|120">Mailroom 600 Full Tub (120 min)</option>
                <option value="Mailroom 600 .75 Tub|90">Mailroom 600 .75 Tub (90 min)</option>
                <option value="Mailroom 600 .50 Tub|60">Mailroom 600 .50 Tub (60 min)</option>
                <option value="Mailroom 600 .25 Tub|30">Mailroom 600 .25 Tub (30 min)</option>
            </optgroup>

            <optgroup label="900 FMLA">
                <option value="FMLA|1">FMLA (1 min)</option>
            </optgroup>

            <optgroup label="Misc. Mailroom Duties">
                <option value="Box Review Tubs|60">Box Review Tubs (60 min)</option>
                <option value="Box Review ECM|1">Box Review ECM (1 min)</option>
                <option value="Agencies|1">Agencies (1 min)</option>
                <option value="Blue Books|4">Blue Books (4 min)</option>
                <option value="eOPF|1">eOPF (1 min)</option>
                <option value="Mailroom Meeting|1">Mailroom Meeting (1 min)</option>
            </optgroup>
        </select>

        <label for="quantity">Quantity:</label>
        <input type="number" id="quantity" placeholder="Enter quantity" min="1">

        <h3>Add New Task</h3>
        <input type="text" id="newTaskName" placeholder="Task Name">
        <input type="number" id="newTaskTime" placeholder="Time (min)" min="1">
        <button id="addNewTask">Add Task to List</button>

        <button id="addTask">Add Task</button>

        <h2>Your Tasks:</h2>
        <p id="successMessage" style="display: none; color: green; font-weight: bold;"></p>

        <ul id="taskList"></ul>

        <div id="totalTime">435 minutes remaining</div>

        <!-- Changed from textarea to table -->
        <label for="eodReport">EOD Report:</label>
        <table id="eodTable">
            <thead>
                <tr>
                    <th>Task</th>
                    <th>Time (min)</th>
                    <th>Quantity/Inches</th>
                </tr>
            </thead>
            <tbody id="eodTableBody"></tbody>
        </table>
        <!-- End of new table -->

        <button id="copyEodReport">Copy EOD Report</button>
    </div>

    <script>
        const taskDropdown = document.getElementById('task');
        const quantityInput = document.getElementById('quantity');
        const addTaskButton = document.getElementById('addTask');
        const taskList = document.getElementById('taskList');
        const totalTimeDisplay = document.getElementById('totalTime');
        const eodTable = document.getElementById('eodTable'); // Reference to the table
        const eodTableBody = document.getElementById('eodTableBody');
        const copyEodReportButton = document.getElementById('copyEodReport');

        let totalTime = 435;
        let tasks = [];

        const addNewTaskButton = document.getElementById('addNewTask');
        const newTaskNameInput = document.getElementById('newTaskName');
        const newTaskTimeInput = document.getElementById('newTaskTime');
        

        const resetInputs = () => {
    taskDropdown.selectedIndex = 0; // Reset task selection
    quantityInput.value = ""; // Clear quantity input
};

// Function to show success message
const showSuccessMessage = (message) => {
    const successMessage = document.getElementById('successMessage');
    successMessage.textContent = message;
    successMessage.style.display = 'block';

    setTimeout(() => {
        successMessage.style.display = 'none';
    }, 3000); // Hide message after 3 seconds
};

// Enable "Enter" key submission for the quantity input (Add Task)
quantityInput.addEventListener("keypress", (event) => {
    if (event.key === "Enter") {
        event.preventDefault();
        addTaskButton.click();
    }
});

// Modify the "Add Task" button event listener to reset inputs
addTaskButton.addEventListener('click', () => {
    const selectedTask = taskDropdown.value;
    const quantity = parseInt(quantityInput.value);

    if (!selectedTask) {
        alert('Please select a task!');
        return;
    }

    if (quantity < 1 || isNaN(quantity)) {
        alert('Please enter a valid quantity!');
        return;
    }

    const [taskName, taskTime] = selectedTask.split('|');
    const totalTaskTime = parseInt(taskTime) * quantity;
    tasks.push({ name: taskName, quantity, time: totalTaskTime });
    totalTime -= totalTaskTime;

    updateTotalTimeDisplay();
    updateTaskList();
    updateEodReport();
    
    resetInputs(); // Reset fields after adding the task
    showSuccessMessage(`âœ… Task "${taskName}" added successfully!`);
});

// Enable "Enter" key submission for the new task inputs (Add New Task)
const resetNewTaskInputs = () => {
    newTaskNameInput.value = ""; // Clear task name input
    newTaskTimeInput.value = ""; // Clear task time input
};

[newTaskNameInput, newTaskTimeInput].forEach(input => {
    input.addEventListener("keypress", (event) => {
        if (event.key === "Enter") {
            event.preventDefault();
            addNewTaskButton.click();
        }
    });
});

// Modify the "Add New Task" button event listener to reset inputs
addNewTaskButton.addEventListener('click', () => {
    const taskName = newTaskNameInput.value.trim();
    const taskTime = parseInt(newTaskTimeInput.value);

    if (!taskName || isNaN(taskTime) || taskTime < 1) {
        alert('Please provide a valid task name and time.');
        return;
    }

    const newOption = document.createElement('option');
    newOption.value = `${taskName}|${taskTime}`;
    newOption.textContent = `${taskName} (${taskTime} min)`;
    taskDropdown.appendChild(newOption);

    resetNewTaskInputs(); // Reset new task inputs after adding
    showSuccessMessage(`âœ… New task "${taskName}" added to the list!`);
});


        const updateTotalTimeDisplay = () => {
            if (totalTime < 0) {
                totalTimeDisplay.classList.add('negative');
                const percentageOver = (Math.abs(totalTime) / 435) * 100; // Calculate percentage
                totalTimeDisplay.textContent = `${totalTime} minutes remaining (-${percentageOver.toFixed(2)}% over)`;
            } else {
                totalTimeDisplay.classList.remove('negative');
                totalTimeDisplay.textContent = `${totalTime} minutes remaining`;
            }
        };

        const updateTaskList = () => {
            taskList.innerHTML = '';
            tasks.forEach((task, index) => {
                const taskItem = document.createElement('li');
                taskItem.textContent = `${task.name} (x${task.quantity}, ${task.time} min)`;

                const deleteButton = document.createElement('button');
                deleteButton.textContent = 'âœ–';
                deleteButton.addEventListener('click', () => {
                    totalTime += task.time;
                    tasks.splice(index, 1);
                    updateTotalTimeDisplay();
                    updateTaskList();
                    updateEodReport();
                });

                taskItem.appendChild(deleteButton);
                taskList.appendChild(taskItem);
            });
        };

        const updateEodReport = () => {
    eodTableBody.innerHTML = '';
    eodTable.style.display = tasks.length > 0 ? 'table' : 'none'; // ðŸ”¹ NEW CODE: Show table only if tasks exist

    tasks.forEach(task => {
        const row = document.createElement('tr');
        row.innerHTML = `<td>${task.name}</td><td>${task.time}</td><td>${task.quantity}</td>`;
        eodTableBody.appendChild(row);
    });
};



copyEodReportButton.addEventListener('click', async () => {
    if (tasks.length === 0) {
        alert('No tasks to copy.');
        return;
    }

    // ðŸ”¹ NEW CODE: Construct HTML table as a string
    let reportText = `<table border="1" style="border-collapse: collapse;">
        <thead>
            <tr>
                <th style="padding: 5px; background-color: #003366; color: white;">Task</th>
                <th style="padding: 5px; background-color: #003366; color: white;">Time (min)</th>
                <th style="padding: 5px; background-color: #003366; color: white;">Quantity</th>
            </tr>
        </thead>
        <tbody>`;

    tasks.forEach(task => {
        reportText += `<tr>
            <td style="padding: 5px; border: 1px solid black;">${task.name}</td>
            <td style="padding: 5px; border: 1px solid black;">${task.time}</td>
            <td style="padding: 5px; border: 1px solid black;">${task.quantity}</td>
        </tr>`;
    });

    reportText += `</tbody></table>`;

    // ðŸ”¹ NEW: Use Clipboard API to copy HTML table
    try {
        await navigator.clipboard.write([
            new ClipboardItem({
                "text/html": new Blob([reportText], { type: "text/html" }),
                "text/plain": new Blob([reportText.replace(/<[^>]*>?/gm, '')], { type: "text/plain" }) // Plain text fallback
            })
        ]);
        alert("EOD Report copied as a table! Paste it into your document.");
    } catch (err) {
        console.error("Clipboard write failed, falling back to textarea copy", err);

        // Fallback: Copy using a hidden textarea
        const tempTextArea = document.createElement("textarea");
        tempTextArea.value = reportText;
        document.body.appendChild(tempTextArea);
        tempTextArea.select();
        document.execCommand("copy");
        document.body.removeChild(tempTextArea);
        
        alert("EOD Report copied (fallback method). Formatting may be lost.");
    }
});


    </script>
</body>
</html>
